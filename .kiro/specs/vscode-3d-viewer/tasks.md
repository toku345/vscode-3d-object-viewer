# Implementation Plan

- [ ] 1. プロジェクト基盤の設定とコマンド登録
  - package.jsonに3D Viewerコマンドを追加し、適切なactivationEventsを設定する
  - extension.tsでコマンドハンドラーを登録し、基本的な拡張機能構造を確立する
  - _Requirements: 1.1_

- [ ] 2. Webviewパネル管理システムの実装
  - WebviewパネルのCRUD操作を管理するViewerPanelManagerクラスを作成する
  - パネルの作成、設定、破棄を適切に処理するメソッドを実装する
  - _Requirements: 1.1, 1.3, 4.4_

- [ ] 3. Webviewコンテンツプロバイダーの実装
  - HTMLコンテンツを生成するWebviewContentProviderクラスを作成する
  - Three.jsライブラリを含む適切なHTMLテンプレートを生成する
  - CSP設定を含むセキュアなWebviewコンテンツを提供する
  - _Requirements: 1.2, 4.1_

- [ ] 4. Three.js 3Dシーンの基本実装
  - [ ] 4.1 3Dシーンの初期化システムを実装
    - THREE.Scene、Camera、Rendererの基本セットアップを行う
    - WebGLレンダラーの初期化とcanvas要素への統合を実装する
    - _Requirements: 1.2, 4.1_

  - [ ] 4.2 デフォルト立方体オブジェクトの作成
    - THREE.BoxGeometryを使用して立方体を作成する
    - 適切なマテリアルとライティングを設定する
    - シーンに立方体を追加し、初期表示を確認する
    - _Requirements: 1.2_

- [ ] 5. マウスインタラクション機能の実装
  - [ ] 5.1 マウスドラッグによる回転機能
    - マウスダウン、ムーブ、アップイベントのハンドラーを実装する
    - ドラッグ距離を回転角度に変換するロジックを作成する
    - X軸とY軸周りの回転を適切に処理する
    - _Requirements: 2.1, 2.2, 2.3, 2.4_

  - [ ] 5.2 マウスホイールによるズーム機能
    - ホイールイベントハンドラーを実装する
    - スケール値の計算と制限（最小・最大値）を実装する
    - スムーズなズーム操作を提供する
    - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [ ] 6. エラーハンドリングとWebGL対応チェック
  - WebGLサポートの検出機能を実装する
  - WebGL未サポート時の適切なエラーメッセージ表示を追加する
  - Three.jsの初期化失敗時のフォールバック処理を実装する
  - _Requirements: 4.2_

- [ ] 7. リソース管理とクリーンアップ機能
  - Webviewパネル閉じ時のThree.jsリソース解放を実装する
  - イベントリスナーの適切な削除処理を追加する
  - メモリリーク防止のためのリソース管理を確立する
  - _Requirements: 4.3_

- [ ] 8. 複数パネル対応とパネル管理
  - 複数の3Dビューアーパネルの独立管理を実装する
  - 各パネルの状態を個別に保持する仕組みを作成する
  - パネル間の干渉を防ぐ分離機能を実装する
  - _Requirements: 4.4_

- [ ] 9. ユニットテストの実装
  - [ ] 9.1 拡張機能コマンドのテスト
    - コマンド登録の正確性をテストする
    - コマンド実行時の動作をテストする
    - _Requirements: 4.1_

  - [ ] 9.2 Webviewパネル管理のテスト
    - パネル作成、設定、破棄の各機能をテストする
    - HTMLコンテンツ生成の正確性をテストする
    - _Requirements: 1.1, 1.3_

- [ ] 10. 統合テストとエンドツーエンドテスト
  - コマンド実行から3D表示までの完全なワークフローをテストする
  - 複数パネルの独立動作をテストする
  - エラーシナリオ（WebGL未サポート）のテストを実装する
  - _Requirements: 4.2, 4.4_